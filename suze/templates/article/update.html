{% extends 'common/index.html' %}

{% block css %}
<style>
  .uk-list li {
    float: left;
    margin-right: 10px;
  }
</style>
<link rel="stylesheet" href="{{ url_for('static', filename='umeditor/themes/default/_css/umeditor.css') }}">
{% endblock %}

{% block container %}
<nav class="uk-navbar">
  <ul class="uk-navbar-nav">
    {% include "nav.html" %}
  </ul>
  <div class="uk-navbar-flip">
    <ul class="uk-navbar-nav">
      {% if current_user.is_authenticated() %}
      <li class="uk-parent" data-uk-dropdown>
        <a href="">{{ current_user.username }} <i class="uk-icon-caret-down"></i></a>
        <div class="uk-dropdown uk-dropdown-navbar">
          <ul class="uk-nav uk-nav-navbar">
            {% include "dropdown.html" %}
          </ul>
        </div>
      </li>
      {% else %}
      <li><a href="{{ url_for('Common.register') }}">注册</a></li>
      <li><a href="{{ url_for('Common.login') }}">登录</a></li>
      {% endif %}
    </ul>
  </div>
</nav>

{% block content %}
<form class="uk-form uk-form-stacked uk-width-medium-1-1 uk-container-center"
  method="POST" action="{{ url_for('Article.update', article_id=article.id) }}">
  {{ form.raw_content }}
  <div class="uk-form-row">
    {{ form.title.label(class='uk-form-label') }}
    {{ form.title(value=article.title, style="width:50%;") }}
  </div>
  <div class="uk-form-row">
    {{ form.tags.label(class='uk-form-label') }}
    {{ form.tags(value=tags, style="width:50%;") }}
  </div>
  <div class="uk-form-row">
    {{ form.html_content.label(class='uk-form-label') }}
    <textarea id="editor" name="html_content" cols="30" rows="10" style="width:100%;height:240px;">{{ article.html_content }}</textarea>
  </div>
  <div class="uk-form-row uk-clearfix">
    <button id="create" type="submit" class="uk-button uk-button-primary uk-float-right">发布</button>
  </div>
</form>
{% endblock %}

{% endblock %}

{% block js %}
<script src="{{ url_for('static', filename='umeditor/umeditor.config.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static', filename='umeditor/editor_api.js') }}" type="text/javascript"></script>
<script type="text/javascript">
  var um = UM.getEditor('editor');
  $(document).ready(function(){
    $("#create").click(function(){
      $("#raw_content").val(um.getContentTxt());
    });
  });
</script>
{% endblock %}
